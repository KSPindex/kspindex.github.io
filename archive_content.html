<!DOCTYPE html>
<html lang="ko" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IndexSpace ë³´ê´€í•¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000000; /* ê²€ì€ìƒ‰ ë°°ê²½ */
            color: #ffffff; /* í°ìƒ‰ í…ìŠ¤íŠ¸ */
            min-height: 100vh;
            display: flex; /* Flexboxë¥¼ ì‚¬ìš©í•˜ì—¬ ì½˜í…ì¸  ì¤‘ì•™ ì •ë ¬ */
            flex-direction: column; /* ì„¸ë¡œ ë°©í–¥ ì •ë ¬ */
            justify-content: flex-start; /* ìƒë‹¨ë¶€í„° ì •ë ¬ */
            align-items: center; /* ìˆ˜í‰ ì¤‘ì•™ ì •ë ¬ */
        }
        /* index.htmlê³¼ ë™ì¼í•œ ìƒ‰ìƒ/ê·¸ë¦¼ì/í…Œë‘ë¦¬ í´ë˜ìŠ¤ ì‚¬ìš© */
        .bg-primary-dark { background-color: #1a1a1a; } /* í—¤ë”/í‘¸í„° ë“± */
        .bg-section-dark { background-color: #2a2a2a; } /* ì„¹ì…˜ ë°°ê²½ */
        .text-light { color: #ffffff; } /* ê¸°ë³¸ ë°ì€ í…ìŠ¤íŠ¸ */
        .text-muted-light { color: #aaaaaa; } /* ë®¤íŠ¸ëœ ë°ì€ í…ìŠ¤íŠ¸ */
        .border-thin-white { border: 1px solid rgba(255, 255, 255, 0.3); } /* ì–‡ì€ í°ìƒ‰ í…Œë‘ë¦¬ */
        .hover\:text-accent-white:hover { color: #ffffff; } /* í˜¸ë²„ ì‹œ í°ìƒ‰ ê°•ì¡° */
        .shadow-dark { box-shadow: 0 4px 15px rgba(255, 255, 255, 0.1); } /* ë°ì€ ê·¸ë¦¼ì */

        /* ë©”ì¸ ì„¹ì…˜ ê·¸ë¼ë°ì´ì…˜ - index.htmlê³¼ ë™ì¼ */
        .bg-gradient-home {
            background-image: linear-gradient(to bottom right, #000000, #333333);
        }

        /* í°íŠ¸ í¬ê¸° ì¡°ì • - index.htmlê³¼ ë™ì¼í•˜ê²Œ */
        .text-6xl { font-size: 4rem; }
        .text-7xl { font-size: 5rem; }
        .text-xl { font-size: 1.25rem; }
        .text-2xl { font-size: 1.5rem; }
        .text-base { font-size: 1rem; }
        .text-lg { font-size: 1.125rem; }
        .text-sm { font-size: 0.875rem; }
        .leading-relaxed { line-height: 1.8; }

        /* ëª¨ë°”ì¼ í™˜ê²½ì—ì„œëŠ” í°íŠ¸ í¬ê¸° ì¡°ì • (ë°˜ì‘í˜•) - index.htmlê³¼ ë™ì¼ */
        @media (max-width: 767px) {
            .text-6xl { font-size: 3rem; }
            .text-7xl { font-size: 4rem; }
            .text-xl { font-size: 1.125rem; }
            .text-2xl { font-size: 1.25rem; }
            .text-base { font-size: 1rem; }
            .text-lg { font-size: 1.125rem; }
            .text-sm { font-size: 0.75rem; }
            .leading-relaxed { line-height: 1.6; }
        }

        /* íƒ­ ê´€ë ¨ ìŠ¤íƒ€ì¼ */
        .tab-button {
            padding: 10px 20px;
            border-radius: 8px;
            cursor: pointer;
            transition: background-color 0.3s ease, color 0.3s ease;
            background-color: #333333;
            color: #aaaaaa;
            font-weight: 600;
        }
        .tab-button.active {
            background-color: #ffffff;
            color: #000000;
        }
        .upload-button {
            background-color: #444444; /* íšŒìƒ‰ */
            color: #ffffff;
            font-size: 1.5rem; /* + ê¸°í˜¸ í¬ê¸° */
            width: 40px;
            height: 40px;
            border-radius: 50%; /* ì›í˜• */
            display: flex;
            justify-content: center;
            align-items: center;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .upload-button:hover {
            background-color: #666666;
        }
        .file-list-item {
            padding: 8px 12px;
            background-color: #333333;
            border-radius: 6px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap; /* ë‚´ìš©ì´ ë§ì„ ë•Œ ì¤„ ë°”ê¿ˆ */
        }
        .file-list-item .delete-btn {
            background-color: #dc2626; /* Red-600 */
            color: white;
            padding: 2px 8px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 0.8rem;
            transition: background-color 0.2s ease;
            flex-shrink: 0; /* ë²„íŠ¼ì´ ì¤„ì–´ë“¤ì§€ ì•Šë„ë¡ */
        }
        .file-list-item .file-info {
            display: flex;
            align-items: center;
            flex-grow: 1; /* íŒŒì¼ ì´ë¦„ì´ ê³µê°„ì„ ì°¨ì§€í•˜ë„ë¡ */
            min-width: 0; /* í…ìŠ¤íŠ¸ ë„˜ì¹  ë•Œ ì¤„ ë°”ê¿ˆ */
        }
        .file-preview {
            max-width: 60px; /* ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€/ë¹„ë””ì˜¤ ìµœëŒ€ ë„ˆë¹„ */
            max-height: 60px; /* ë¯¸ë¦¬ë³´ê¸° ì´ë¯¸ì§€/ë¹„ë””ì˜¤ ìµœëŒ€ ë†’ì´ */
            object-fit: contain; /* ë¹„ìœ¨ ìœ ì§€í•˜ë©° ì»¨í…Œì´ë„ˆì— ë§ì¶¤ */
            margin-right: 10px; /* íŒŒì¼ ì´ë¦„ê³¼ì˜ ê°„ê²© */
            border-radius: 4px;
            cursor: pointer; /* í´ë¦­ ê°€ëŠ¥í•˜ë„ë¡ ì»¤ì„œ ë³€ê²½ */
        }

        /* ëª¨ë‹¬ ìŠ¤íƒ€ì¼ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.8);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
            opacity: 0;
            visibility: hidden;
            transition: opacity 0.3s ease, visibility 0.3s ease;
        }
        .modal-overlay.active {
            opacity: 1;
            visibility: visible;
        }
        .modal-content {
            background-color: #1a1a1a;
            padding: 20px;
            border-radius: 8px;
            max-width: 90%;
            max-height: 90%;
            display: flex;
            flex-direction: column;
            align-items: center;
            position: relative;
        }
        .modal-content img, .modal-content video {
            max-width: 100%;
            max-height: 80vh; /* ë·°í¬íŠ¸ ë†’ì´ì˜ 80% */
            object-fit: contain;
            margin-bottom: 15px;
        }
        .modal-close-btn {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #dc2626;
            color: white;
            border: none;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            font-size: 1.2rem;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            transition: background-color 0.2s ease;
        }
        .modal-close-btn:hover {
            background-color: #b91c1c;
        }
    </style>
</head>
<body class="bg-black text-light">
    <div class="w-full py-4 px-4 absolute top-0 left-0 bg-primary-dark shadow-md z-10">
        <a href="index.html" class="text-3xl font-thin text-white hover:text-accent-white transition duration-300">indexSpace ëŒì•„ê°€ê¸°</a>
    </div>

    <main class="container mx-auto px-4 py-8 mt-20">
        <section id="archive-content" class="mb-12 min-h-screen flex flex-col items-center justify-start text-center bg-section-dark rounded-lg shadow-dark p-8 border-thin-white">
            <h2 class="text-5xl md:text-6xl font-extrabold mb-6 tracking-tight">IndexSpace ë³´ê´€í•¨</h2>
            <p class="text-xl md:text-2xl mb-8 leading-relaxed text-muted-light">
                ì´ê³³ì— ì¶”ê°€í•˜ëŠ” íŒŒì¼ì€ ë‹¤ë¥¸ ì‚¬ëŒê³¼ ê³µìœ ë˜ì§€ ì•ŠìŠµë‹ˆë‹¤.<br>
                ì´ ë³´ê´€í•¨ì€ ì‚¬ì§„ì´ë‚˜ ì˜ìƒ íŒŒì¼ì„ ë„£ê³  ì •ë¦¬í•˜ê³  ë‚˜ì¤‘ì— ë‹¤ì‹œ í™•ì¸í•˜ê¸° ìœ„í•¨ì…ë‹ˆë‹¤.
            </p>

            <div class="flex items-center justify-center space-x-4 mb-8 w-full max-w-2xl">
                <div class="flex-grow flex justify-center space-x-2">
                    <button id="tab-photo" class="tab-button active" data-tab="photo">ì‚¬ì§„ íƒ­</button>
                    <button id="tab-video" class="tab-button" data-tab="video">ì˜ìƒ íƒ­</button>
                    <button id="tab-file" class="tab-button" data-tab="file">íŒŒì¼ íƒ­</button>
                </div>
                <input type="file" id="fileInput" class="hidden" multiple> <button id="uploadBtn" class="upload-button" data-current-tab="photo">+</button>
            </div>

            <div id="content-photo" class="tab-content w-full max-w-4xl bg-gray-800 p-6 rounded-lg border border-gray-700">
                <h3 class="text-2xl font-semibold mb-4 text-white">ì‚¬ì§„ ëª©ë¡</h3>
                <div id="photo-list" class="text-left space-y-2">
                    </div>
            </div>

            <div id="content-video" class="tab-content hidden w-full max-w-4xl bg-gray-800 p-6 rounded-lg border border-gray-700">
                <h3 class="text-2xl font-semibold mb-4 text-white">ì˜ìƒ ëª©ë¡</h3>
                <div id="video-list" class="text-left space-y-2">
                    </div>
            </div>

            <div id="content-file" class="tab-content hidden w-full max-w-4xl bg-gray-800 p-6 rounded-lg border border-gray-700">
                <h3 class="text-2xl font-semibold mb-4 text-white">íŒŒì¼ ëª©ë¡</h3>
                <div id="file-list" class="text-left space-y-2">
                    </div>
            </div>

            <p class="text-base text-gray-500 mt-10">KSPê°€ ì¼ìŒ</p>
            <p class="text-sm text-gray-600 mt-2">ì°¸ê³ : íŒŒì¼ ì—…ë¡œë“œ ê¸°ëŠ¥ì€ í´ë¼ì´ì–¸íŠ¸ ì¸¡ì—ì„œë§Œ ì‘ë™í•˜ë©°, ì‹¤ì œ íŒŒì¼ ì €ì¥ì€ ì„œë²„ê°€ í•„ìš”í•©ë‹ˆë‹¤.</p>
        </section>
    </main>

    <footer class="bg-primary-dark text-white py-6 text-center w-full">
        <p>&copy; 2025 IndexSpace. All Rights Reserved.</p>
    </footer>

    <div id="previewModal" class="modal-overlay">
        <div class="modal-content">
            <button class="modal-close-btn" id="closeModalBtn">&times;</button>
            <img id="modalImage" src="" alt="ë¯¸ë¦¬ë³´ê¸°" class="hidden">
            <video id="modalVideo" src="" controls class="hidden"></video>
            <p id="modalFileName" class="text-lg text-white mt-2 break-all"></p>
        </div>
    </div>

    <script>
        // ë¹„ë°€ë²ˆí˜¸ ì—†ì´ ì§ì ‘ ì ‘ê·¼í•˜ëŠ” ê²½ìš° ë¦¬ë‹¤ì´ë ‰íŠ¸
        window.onload = () => {
            if (sessionStorage.getItem('indexspace_archive_access') !== 'true') {
                window.location.href = 'archive.html'; // ì ‘ê·¼ ê¶Œí•œ ì—†ìœ¼ë©´ ë¹„ë°€ë²ˆí˜¸ í˜ì´ì§€ë¡œ
            }
            
            showTab('photo');
            loadFilesFromLocalStorage();
        };

        const tabButtons = document.querySelectorAll('.tab-button');
        const tabContents = document.querySelectorAll('.tab-content');
        const uploadBtn = document.getElementById('uploadBtn');
        const fileInput = document.getElementById('fileInput');
        const previewModal = document.getElementById('previewModal');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const modalImage = document.getElementById('modalImage');
        const modalVideo = document.getElementById('modalVideo');
        const modalFileName = document.getElementById('modalFileName');

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                const tabId = button.dataset.tab;
                showTab(tabId);
            });
        });

        function showTab(tabId) {
            tabButtons.forEach(button => button.classList.remove('active'));
            tabContents.forEach(content => content.classList.add('hidden'));

            document.getElementById(`tab-${tabId}`).classList.add('active');
            document.getElementById(`content-${tabId}`).classList.remove('hidden');
            uploadBtn.dataset.currentTab = tabId;
        }

        uploadBtn.addEventListener('click', () => {
            fileInput.click();
        });

        fileInput.addEventListener('change', (event) => {
            const files = event.target.files; // ì—¬ëŸ¬ íŒŒì¼ ì„ íƒ ê°€ëŠ¥
            if (!files.length) return;

            const currentTab = uploadBtn.dataset.currentTab;
            
            for (let i = 0; i < files.length; i++) {
                const file = files[i];
                const fileType = file.type;
                let isValid = true;
                let errorMessage = '';

                // íŒŒì¼ ìœ íš¨ì„± ê²€ì‚¬
                if (currentTab === 'photo') {
                    if (!fileType.startsWith('image/jpeg') && !fileType.startsWith('image/png')) {
                        isValid = false;
                        errorMessage = 'ì‚¬ì§„ íƒ­ì—ëŠ” JPG, JPEG, PNG íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
                    }
                } else if (currentTab === 'video') {
                    if (!fileType.startsWith('video/mp4') && !fileType.startsWith('video/mov') && !fileType.startsWith('video/avi') && !fileType.startsWith('video/webm')) {
                        isValid = false;
                        errorMessage = 'ì˜ìƒ íƒ­ì—ëŠ” MP4, MOV, AVI, WEBM íŒŒì¼ë§Œ ì—…ë¡œë“œí•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.';
                    }
                }
                // 'file' íƒ­ì€ ëª¨ë“  íŒŒì¼ í—ˆìš©

                if (isValid) {
                    addFileToList(file, currentTab); // íŒŒì¼ ê°ì²´ ìì²´ë¥¼ ì „ë‹¬
                } else {
                    alert(errorMessage); // ì‚¬ìš©ìì—ê²Œ ì˜¤ë¥˜ ë©”ì‹œì§€ ì•Œë¦¼
                }
            }

            fileInput.value = ''; // íŒŒì¼ ì…ë ¥ í•„ë“œ ì´ˆê¸°í™” (ë™ì¼ íŒŒì¼ ì¬ì„ íƒ ê°€ëŠ¥í•˜ê²Œ)
        });

        function addFileToList(file, tabId) {
            let files = JSON.parse(localStorage.getItem(`indexspace_${tabId}_files`) || '[]');
            
            // ì¤‘ë³µ ë°©ì§€ë¥¼ ìœ„í•´ íŒŒì¼ ì´ë¦„ë§Œìœ¼ë¡œ ë¹„êµ
            const isDuplicate = files.some(item => item.name === file.name);

            if (!isDuplicate) {
                // íŒŒì¼ ìì²´ë¥¼ ì €ì¥í•˜ëŠ” ëŒ€ì‹ , íŒŒì¼ ì´ë¦„ê³¼ ë¯¸ë¦¬ë³´ê¸° URL ì €ì¥
                const fileRecord = {
                    name: file.name,
                    type: file.type,
                    size: file.size,
                    // ì´ë¯¸ì§€/ë¹„ë””ì˜¤ íŒŒì¼ë§Œ ë¯¸ë¦¬ë³´ê¸° URL ìƒì„±
                    url: (file.type.startsWith('image/') || file.type.startsWith('video/')) ? URL.createObjectURL(file) : null
                };
                files.push(fileRecord);
                localStorage.setItem(`indexspace_${tabId}_files`, JSON.stringify(files));
            }
            
            renderFileList(tabId); // ëª©ë¡ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
        }

        function renderFileList(tabId) {
            const listElement = document.getElementById(`${tabId}-list`);
            listElement.innerHTML = ''; // ê¸°ì¡´ ëª©ë¡ ì§€ìš°ê¸°

            let files = JSON.parse(localStorage.getItem(`indexspace_${tabId}_files`) || '[]');

            if (files.length === 0) {
                listElement.innerHTML = `<p class="text-muted-light">${getTabPlaceholderMessage(tabId)}</p>`;
                return;
            }

            files.forEach(fileRecord => {
                const listItem = document.createElement('div');
                listItem.classList.add('file-list-item');
                
                let previewHtml = '';
                if (fileRecord.url) {
                    if (fileRecord.type.startsWith('image/')) {
                        previewHtml = `<img src="${fileRecord.url}" alt="${fileRecord.name}" class="file-preview" data-file-url="${fileRecord.url}" data-file-type="${fileRecord.type}" data-file-name="${fileRecord.name}">`;
                    } else if (fileRecord.type.startsWith('video/')) {
                        // ë¹„ë””ì˜¤ëŠ” autoplayë¥¼ ë„ê³  controlsë¥¼ ì¶”ê°€í•˜ì—¬ ì¬ìƒ ê°€ëŠ¥í•˜ê²Œ
                        previewHtml = `<video src="${fileRecord.url}" controls class="file-preview" data-file-url="${fileRecord.url}" data-file-type="${fileRecord.type}" data-file-name="${fileRecord.name}"></video>`;
                    }
                } else {
                    // ì¼ë°˜ íŒŒì¼ ì•„ì´ì½˜ ë˜ëŠ” ê¸°ë³¸ ì•„ì´ì½˜
                    previewHtml = `<span class="text-lg mr-2">ğŸ“„</span>`; // ê¸°ë³¸ íŒŒì¼ ì•„ì´ì½˜
                }

                listItem.innerHTML = `
                    <div class="file-info">
                        ${previewHtml}
                        <span class="text-white break-all">${fileRecord.name}</span>
                    </div>
                    <button class="delete-btn" data-file-name="${fileRecord.name}" data-tab-id="${tabId}">ì‚­ì œ</button>
                `;
                listElement.appendChild(listItem);
            });

            // ë¯¸ë¦¬ë³´ê¸° í´ë¦­ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            listElement.querySelectorAll('.file-preview').forEach(previewElement => {
                previewElement.addEventListener('click', (e) => {
                    const url = e.target.dataset.fileUrl;
                    const type = e.target.dataset.fileType;
                    const name = e.target.dataset.fileName;
                    
                    showPreviewModal(url, type, name);
                });
            });

            // ì‚­ì œ ë²„íŠ¼ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆ ì¶”ê°€
            listElement.querySelectorAll('.delete-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const fileNameToDelete = e.target.dataset.fileName;
                    const tabIdToDelete = e.target.dataset.tabId;
                    deleteFileFromList(fileNameToDelete, tabIdToDelete);
                });
            });
        }

        function deleteFileFromList(fileName, tabId) {
            let files = JSON.parse(localStorage.getItem(`indexspace_${tabId}_files`) || '[]');
            
            // ì‚­ì œí•  ë ˆì½”ë“œ ì°¾ì•„ì„œ URL.revokeObjectURL í˜¸ì¶œ
            const fileToDeleteRecord = files.find(item => item.name === fileName);
            if (fileToDeleteRecord && fileToDeleteRecord.url) {
                URL.revokeObjectURL(fileToDeleteRecord.url); // ë©”ëª¨ë¦¬ í•´ì œ
            }

            files = files.filter(item => item.name !== fileName);
            localStorage.setItem(`indexspace_${tabId}_files`, JSON.stringify(files));
            renderFileList(tabId); // ëª©ë¡ ë‹¤ì‹œ ê·¸ë¦¬ê¸°
        }

        function loadFilesFromLocalStorage() {
            renderFileList('photo');
            renderFileList('video');
            renderFileList('file');
        }

        function getTabName(tabId) {
            switch(tabId) {
                case 'photo': return 'ì‚¬ì§„';
                case 'video': return 'ì˜ìƒ';
                case 'file': return 'íŒŒì¼';
                default: return '';
            }
        }

        function getTabPlaceholderMessage(tabId) {
            switch(tabId) {
                case 'photo': return 'ì´ê³³ì— ì¶”ê°€ëœ ì‚¬ì§„ íŒŒì¼ë“¤ì´ í‘œì‹œë©ë‹ˆë‹¤.';
                case 'video': return 'ì´ê³³ì— ì¶”ê°€ëœ ì˜ìƒ íŒŒì¼ë“¤ì´ í‘œì‹œë©ë‹ˆë‹¤.';
                case 'file': return 'ì´ê³³ì— ì¶”ê°€ëœ ëª¨ë“  ì¢…ë¥˜ì˜ íŒŒì¼ ëª©ë¡ì´ í‘œì‹œë©ë‹ˆë‹¤.';
                default: return '';
            }
        }

        // ëª¨ë‹¬ ê´€ë ¨ í•¨ìˆ˜
        function showPreviewModal(url, type, name) {
            modalImage.classList.add('hidden');
            modalVideo.classList.add('hidden');

            if (type.startsWith('image/')) {
                modalImage.src = url;
                modalImage.classList.remove('hidden');
            } else if (type.startsWith('video/')) {
                modalVideo.src = url;
                modalVideo.classList.remove('hidden');
            }
            modalFileName.textContent = name;
            previewModal.classList.add('active');
        }

        closeModalBtn.addEventListener('click', () => {
            previewModal.classList.remove('active');
            modalImage.src = ''; // ì´ë¯¸ì§€/ë¹„ë””ì˜¤ ì†ŒìŠ¤ ì´ˆê¸°í™”
            modalVideo.src = '';
            modalVideo.pause(); // ë¹„ë””ì˜¤ ì¬ìƒ ì¤‘ì§€
        });

        previewModal.addEventListener('click', (e) => {
            if (e.target === previewModal) { // ì˜¤ë²„ë ˆì´ ìì²´ë¥¼ í´ë¦­í–ˆì„ ë•Œë§Œ ë‹«ê¸°
                previewModal.classList.remove('active');
                modalImage.src = '';
                modalVideo.src = '';
                modalVideo.pause();
            }
        });
    </script>
</body>
</html>
